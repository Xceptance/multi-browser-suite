lpConnLib.Process({"ResultSet": {"lpCallId":"647070008871-483871058031","lpCallConfirm":"","lpJS_Execute":[{"code_id": "webServerOverride", "js_code": "if (lpMTagConfig.lpServer != 'server.lon.liveperson.net') { lpMTag.overrideLPServer('server.lon.liveperson.net',true); }"},{"code_id": "MTagDef", "js_code": "lpMTagConfig.oemName = 'LivePerson';lpMTagConfig.poweredByURL = 'http://solutions.liveperson.com/ref/lppb.asp';lpMTagConfig.servlet = 'hc/';lpMTagConfig.appletsDirectory = 'applets/v7.8';lpMTagConfig.charSet = 'UTF-8';lpMTagConfig.language = 'ml';lpMTagConfig.credit = 'powered';lpMTagConfig.logoDir = 'icon/lp';lpMTagConfig.useFirstParty = true;lpMTagConfig.allowThirdPartyByServer = true;lpMTagConfig.lpUseSecureCookies =false;lpMTagConfig.lpUseSessionCookies=false;lpMTagConfig.cobrowseEnabled=false;lpMTag.activityMonitor=true;lpMTagConfig.lpSendCookies=true;lpConnLib.postDeleteIfrDelay=3;lpMTagConfig.minimizePost=false;lpMTagConfig.minimizePostMaxGets=3;lpMTagConfig.allowTruncate=false;lpMTagConfig.serverVer='39.7.0.18';lpMTagConfig.serverBuild='214';lpMTagConfig.dbMultipleClickDelay=3;lpMTagConfig.sgpemtAvoidPOST=true;lpMTagConfig.sgpemtMaxUrlLength=500;lpMTagConfig.sgpemtMinUrlLength=100;lpMTagConfig.sgpemtMaxReferLength=300;lpMTagConfig.sgpemtMinReferLength=100;lpMTagConfig.sgpemtMaxTitleLength=100;lpMTagConfig.sgpemtMinTitleLength=50;lpMTagConfig.maxPageWinNameLength=200;lpMTagConfig.sgpemtSplitCookie=false;lpMTagConfig.sgpemtSplitCookieMinDelta=200;lpMTagConfig.LEeventsAPI=true;if(typeof(lpMTagStatic)!='undefined'){if(typeof(lpMTagStatic.onInitMonitor)!='undefined'){for(var i=0;i<lpMTagStatic.onInitMonitor.length;i++){var tempfunc=lpMTagStatic.onInitMonitor[i];try{tempfunc();lpConnLib.log('OK ONLoad fn','EXEC-OK','STATIC-BUTTON')}catch(e){lpConnLib.log('ERROR ONLoad fn='+tempfunc+' &nbsp #'+e+'#','ERROR','STATIC-BUTTON')}}lpMTagStatic.onInitMonitor=[]}}"},{"code_id": "SYSTEM!embedChatEscaped_compact.js", "js_code": "if(!window.lpMTagConfig){window.lpMTagConfig={}}if(!window.lpMTagStatic){window.lpMTagStatic={}}if(typeof(window.lpMTagConfig.frameAPI)=='undefined'){window.lpMTagConfig.frameAPI=window.lpMTagStatic.frameAPI=(function(){var overlayWrapper,imgPath,standByWrapper,template,timer,frame=null,frameTitle,resizeBtn,closeBtn,minMaxBtn,popBtn,closeImg,minImg,popImg,isDragging=false,isResizing=false,callbacks,overlayAttr={pending:false,styleLoaded:false,isMinimize:false,top:10,left:10,offsetX:0,offsetY:0,src:null,title:\"LP Chat\",barLocation:\"BR\",dimensions:{width:400,minWidth:200,minHeight:200,height:300,titleHeight:30}};function init(options){loadStyle(options.skin);imgPath=options.imagesPath;var display='display: none;';if(options.showPopOut){display=''}template=\"<div class='LP_UNSELECTABLE_TXT' style='' id='LP_FRAME_TITLE'><span class='titleText'></span><button id='lp_closeChatButton' title='close' tabIndex=\\\"999\\\" ><img alt='close' class='closeBtn' src=\\\"\"+imgPath+\"/close-normal.png\\\" ></button><button id='lp_minChatButton' tabIndex=\\\"998\\\" title='minimize-maximize' ><img alt='minimize-maximize' src=\\\"\"+imgPath+\"/minimize-normal.png\\\" class='minBtn' ></button><button id='lp_popChatButton' title='pop out' style='\"+display+\"' tabIndex=\\\"997\\\" ><img alt='pop out' src=\\\"\"+imgPath+\"/popout-normal.png\\\" class='popBtn' style='\"+display+\"'></button></div><div><div class='resizeMsk' title='resize'></div><img src=\\\"\"+imgPath+\"/resize.png\\\" class='resizeBtn' alt='resize'><iframe scrolling='auto'></iframe></div>\";callbacks={\"closeFrame\":closeFrame};}function renderOverlay(){overlayAttr.pending=false;overlayWrapper=document.createElement(\"DIV\");overlayWrapper.id=\"LP_CHAT_DIALOG\";overlayWrapper.innerHTML=template;overlayWrapper.style.top=overlayAttr.top+\"px\";overlayWrapper.style.left=overlayAttr.left+\"px\";overlayWrapper.style.zIndex=getMaxZIndex();overlayWrapper.className=\"LP_CHAT_DIALOG LP_UNSELECTABLE_TXT\";frame=overlayWrapper.getElementsByTagName(\"IFRAME\")[0];frame.src=overlayAttr.src;frame.name=overlayAttr.hostOrigin;setDimensions();setDialogUI();addUIListeners();frame.style.display='block';if(standByWrapper!=null){standByWrapper.parentNode.removeChild(standByWrapper);standByWrapper=null}document.body.appendChild(overlayWrapper)}function renderStandBy(){var vp=getViewPortSize();standByWrapper=document.createElement(\"DIV\");standByWrapper.innerHTML=\"Loading ...\";standByWrapper.style.borderRadius=\"5px\";standByWrapper.style.display=\"block\";standByWrapper.style.border=\"1px solid #CCC\";standByWrapper.style.position=\"fixed\";standByWrapper.style.width=overlayAttr.dimensions.width+\"px\";standByWrapper.style.height=overlayAttr.dimensions.height+\"px\";standByWrapper.style.top=overlayAttr.top+\"px\";standByWrapper.style.left=overlayAttr.left+\"px\";standByWrapper.style.boxShadow=\"0 1px 5px 0 rgba(0, 0, 0, 0.3)\";standByWrapper.style.fontFamily=\"arial\";standByWrapper.style.textAlign=\"center\";standByWrapper.style.paddingTop=\"30px\";standByWrapper.style.backgroundColor=\"white\";document.body.appendChild(standByWrapper)}function setDimensions(){if(!overlayAttr.isMinimize){var dimensions=overlayAttr.dimensions;overlayWrapper.style.width=dimensions.width+\"px\";overlayWrapper.style.height=dimensions.height+\"px\";frame.style.width=(dimensions.width)+\"px\";frame.style.height=(dimensions.height-dimensions.titleHeight-1)+\"px\"}}function setDialogUI(){frameTitle=overlayWrapper.querySelector(\"#LP_FRAME_TITLE\");closeImg=frameTitle.querySelector(\".closeBtn\");closeBtn=frameTitle.querySelector(\"#lp_closeChatButton\");minImg=frameTitle.querySelector(\".minBtn\");minMaxBtn=frameTitle.querySelector(\"#lp_minChatButton\");popImg=frameTitle.querySelector(\".popBtn\");popBtn=frameTitle.querySelector(\"#lp_popChatButton\");resizeBtn=overlayWrapper.querySelector(\".resizeBtn\");frameTitle.style.height=overlayAttr.dimensions.titleHeight+\"px\";overlayWrapper.querySelector(\"#LP_FRAME_TITLE .titleText\").innerHTML=overlayAttr.title;bindSpriteImges([{btn:closeBtn,img:closeImg,hover:\"close-hover.png\",normal:\"close-normal.png\"},{btn:minMaxBtn,img:minImg,hover:\"minimize-hover.png\",normal:\"minimize-normal.png\"},{btn:popBtn,img:popImg,hover:\"popout-hover.png\",normal:\"popout-normal.png\"}])}function bindSpriteImges(arrayOfImgElements){if(arrayOfImgElements&&arrayOfImgElements.length>0){for(var i=0;i<arrayOfImgElements.length;i++){arrayOfImgElements[i].btn.addEventListener(\"mouseover\",changeImageSrc(arrayOfImgElements[i].img,imgPath+\"/\"+arrayOfImgElements[i].hover));arrayOfImgElements[i].btn.addEventListener(\"mouseout\",changeImageSrc(arrayOfImgElements[i].img,imgPath+\"/\"+arrayOfImgElements[i].normal))}}}function changeImageSrc(element,path){return function(){element.src=path}}function initOrigin(){sendMsg(getMsgJSON(\"setOrigin\"))}function receiveMsg(e){try{if(e.origin==overlayAttr.origin){var msg=JSON.parse(e.data);switch(msg.action){case \"resizeTo\":resize(msg.data.width,parseInt(msg.data.height,10)+overlayAttr.dimensions.titleHeight);break;case \"resizeBy\":resize(overlayAttr.dimensions.width+msg.data.width,overlayAttr.dimensions.height+msg.data.height+overlayAttr.dimensions.titleHeight);break;case \"endChat\":callbacks[msg.callback]();break;case \"setFrameLocation\":overlayAttr.src=msg.data.location;break;case \"getFrameProperty\":callbacks[msg.callback](msg.data.propValue);break}}}catch(e){console.log(e)}}function sendMsg(msgStr){try{if(overlayAttr.src){frame.contentWindow.postMessage(msgStr,overlayAttr.src)}}catch(e){console.log(e)}}function getMsgJSON(action,data,callback){try{return JSON.stringify({action:action,data:data||null,callback:callback||null})}catch(e){console.log(e);return null}}function addUIListeners(){try{closeBtn.addEventListener(\"click\",requestChatEnd);minMaxBtn.addEventListener(\"click\",minimize);popBtn.addEventListener(\"click\",popOut);window.addEventListener(\"scroll\",onScroll,false);window.addEventListener(\"resize\",onWinResize,false);addDragListeners();resizeBtn.addEventListener(\"mousedown\",startResize);window.addEventListener(\"mouseup\",stopResize,false);window.addEventListener(\"mousemove\",onResize,true);window.addEventListener(\"message\",receiveMsg,false);frame.addEventListener(\"load\",initOrigin);overlayWrapper.addEventListener(\"selectstart\",preventSelection)}catch(e){console.log(e)}}function removeUIListeners(){try{closeBtn.removeEventListener(\"click\",requestChatEnd);minMaxBtn.removeEventListener(\"click\",minimize);popBtn.removeEventListener(\"click\",popOut);window.removeEventListener(\"scroll\",onScroll,false);window.removeEventListener(\"resize\",onWinResize,false);removeDragListeners();resizeBtn.removeEventListener(\"mousedown\",startResize);window.removeEventListener(\"mouseup\",stopResize,false);window.removeEventListener(\"mousemove\",onResize,true);window.removeEventListener(\"message\",receiveMsg,false);frame.removeEventListener(\"load\",initOrigin);overlayWrapper.removeEventListener(\"selectstart\",preventSelection)}catch(e){console.log(e)}}function addDragListeners(){try{frameTitle.addEventListener(\"mousedown\",startDrag,false);window.addEventListener(\"mouseup\",stopDrag,false);window.addEventListener(\"mousemove\",drag,true)}catch(e){console.log(e)}}function removeDragListeners(){try{frameTitle.removeEventListener(\"mousedown\",startDrag,false);window.removeEventListener(\"mouseup\",stopDrag,false);window.removeEventListener(\"mousemove\",drag,true)}catch(e){console.log(e)}}function onWinResize(e){setMaxDimensions();var vp=getViewPortSize();if(overlayAttr.isMinimize){overlayWrapper.style.top=(vp.height-45)+\"px\";overlayWrapper.style.left=(vp.width-220)+\"px\"}else{if(vp.height<overlayAttr.dimensions.height){var screenHeight=vp.height-20;overlayAttr.dimensions.height=parseFloat(screenHeight);setDimensions()}else{var screenHeight=vp.height-20;if(vp.height<790){overlayAttr.dimensions.height=parseFloat(screenHeight);setDimensions()}}overlayWrapper.style.top=\"10px\";overlayWrapper.style.left=\"10px\"}}function preventSelection(e){e.preventDefault();return false}function onScroll(e){if(timer){clearInterval(timer);timer=null}timer=setTimeout(makeFrameOpaque,200);overlayWrapper.style.opacity=0.7}function makeFrameOpaque(){var prop={duration:500,element:overlayWrapper,prop:{opacity:1}};animateTo(prop)}function animateTo(opt,callback){try{var from={};for(var i in opt.prop){if(opt.prop.hasOwnProperty(i)){var suffix=opt.element.style[i].match(/\\D{2}/);suffix=(suffix)?suffix[0]:0;from[i]={val:parseFloat(opt.element.style[i]),suffix:suffix}}}animate({callback:callback,duration:opt.duration||1000,delta:makeEaseOut(circ),step:function(delta){for(var i in opt.prop){if(opt.prop.hasOwnProperty(i)){var dir=(from[i].val>opt.prop[i])?-1:1;opt.element.style[i]=parseFloat(from[i].val+(dir*Math.abs((from[i].val-opt.prop[i])*delta)))+from[i].suffix}}}})}catch(e){console.log(e)}}function makeEaseOut(delta){return function(progress){return 1-delta(1-progress)};}function circ(progress){return 1-Math.sin(Math.acos(progress))}function animate(opts){var start=new Date(),id=setInterval(function(){var timePassed=new Date()-start,progress=timePassed/opts.duration;if(progress>1)progress=1;var delta=opts.delta(progress);opts.step(delta);if(progress==1){clearInterval(id);if(opts.callback){opts.callback()}}},10)}function resize(width,height){width=(width>overlayAttr.dimensions.minWidth)?width:overlayAttr.dimensions.minWidth;height=(height>overlayAttr.dimensions.minHeight)?height:overlayAttr.dimensions.minHeight;width=(width<overlayAttr.dimensions.maxWidth)?width:overlayAttr.dimensions.maxWidth;height=(height<overlayAttr.dimensions.maxHeight)?height:overlayAttr.dimensions.maxHeight;overlayAttr.dimensions.width=parseFloat(width);overlayAttr.dimensions.height=parseFloat(height);setDimensions()}function requestChatEnd(){overlayAttr.isMinimize=false;sendMsg(getMsgJSON(\"endChat\",null,\"closeFrame\"));overlayWrapper.style.display=\"none\";setTimeout(function(){if(frame){closeFrame(true)}},500)}function closeFrame(closeSession){var shouldCloseSession=closeSession,img=new Image(),src=overlayAttr.src,command=\"cmd=windowUnloaded\";if(shouldCloseSession){command=command+\"&closeButtonClicked=true\"}src=src.replace(\"cmd=file\",command);img.src=src;removeUIListeners();overlayWrapper.parentNode.removeChild(overlayWrapper);frame=null}function minimize(){var vp=getViewPortSize();setDialogMode(\"min\");switch(overlayAttr.barLocation){case \"BR\":var prop={duration:300,element:overlayWrapper,prop:{top:vp.height-45,left:vp.width-220,height:30,width:200}};animateTo(prop,hideFrame);break}}function hideFrame(){frame.style.display=\"none\"}function maximize(){frame.style.display=\"block\";setDialogMode(\"max\");var prop={duration:300,element:overlayWrapper,prop:{top:parseFloat(overlayAttr.top),left:parseFloat(overlayAttr.left),height:overlayAttr.dimensions.height,width:overlayAttr.dimensions.width}};animateTo(prop,setDimensions)}function setDialogMode(mod){switch(mod){case \"min\":overlayAttr.isMinimize=true;resizeBtn.style.display=\"none\";minMaxBtn.className=\"maxBtn\";minMaxBtn.removeEventListener(\"click\",minimize);minMaxBtn.addEventListener(\"click\",maximize);minMaxBtn.removeEventListener(\"mouseover\",changeImageSrc(minImg,imgPath+\"/minimize-hover.png\"));minMaxBtn.removeEventListener(\"mouseout\",changeImageSrc(minImg,imgPath+\"/minimize-normal.png\"));minMaxBtn.addEventListener(\"mouseover\",changeImageSrc(minImg,imgPath+\"/maximize-hover.png\"));minMaxBtn.addEventListener(\"mouseout\",changeImageSrc(minImg,imgPath+\"/maximize-normal.png\"));window.removeEventListener(\"scroll\",onScroll,false);removeDragListeners();break;case \"max\":overlayAttr.isMinimize=false;resizeBtn.style.display=\"block\";minMaxBtn.className=\"minBtn\";minMaxBtn.addEventListener(\"click\",minimize);minMaxBtn.removeEventListener(\"click\",maximize);minMaxBtn.removeEventListener(\"mouseover\",changeImageSrc(minImg,imgPath+\"/maximize-hover.png\"));minMaxBtn.removeEventListener(\"mouseout\",changeImageSrc(minImg,imgPath+\"/maximize-normal.png\"));minMaxBtn.addEventListener(\"mouseover\",changeImageSrc(minImg,imgPath+\"/minimize-hover.png\"));minMaxBtn.addEventListener(\"mouseout\",changeImageSrc(minImg,imgPath+\"/minimize-normal.png\"));window.addEventListener(\"scroll\",onScroll,false);addDragListeners();break}}function getViewPortSize(){var e=window,a='inner';if(!('innerWidth' in window)){a='client';e=document.documentElement||document.body}return{width:e[a+'Width'],height:e[a+'Height']};}function popOut(){try{var suffix=(overlayAttr.src.indexOf(\"?\")==-1)?\"?pop_out=true\":\"&pop_out=true\";closeFrame(false);overlayAttr.win=window.open(overlayAttr.src+suffix,\"chatWin\",\"height=\"+overlayAttr.dimensions.height+\",width=\"+overlayAttr.dimensions.width+\",modal=yes,alwaysRaised=yes\")}catch(e){console.log(e)}}function getMaxZIndex(){try{return 2147483647}catch(e){console.log(e);return 1000}}function startResize(e){if(!isResizing){document._saveOndragstartFunction=document.ondragstart;document.ondragstart=function(){return false};isResizing=true;overlayWrapper.querySelector(\".resizeMsk\").style.display=\"block\";document.addEventListener(\"selectstart\",preventSelection)}}function stopResize(e){if(isResizing){document.ondragstart=document._saveOndragstartFunction;delete document._saveOndragstartFunction;isResizing=false;overlayWrapper.querySelector(\".resizeMsk\").style.display=\"none\";document.removeEventListener(\"selectstart\",preventSelection)}}function onResize(e){if(isResizing){var top=parseInt(overlayWrapper.style.top,10),left=parseInt(overlayWrapper.style.left,10);resize(e.clientX-left+5,e.clientY-top+5)}}function startDrag(e){if(e.srcElement.parentNode.id!=\"LP_FRAME_TITLE\"){overlayWrapper.querySelector(\".resizeMsk\").style.display=\"block\";overlayAttr.viewPort=getViewPortSize();overlayAttr.offsetX=e.offsetX;overlayAttr.offsetY=e.offsetY;isDragging=true;overlayWrapper.className=\"LP_DRAGGED_BOX_SHADOW\";document.addEventListener(\"selectstart\",preventSelection);overlayWrapper.style.top=(e.clientY-overlayAttr.offsetY-1)+\"px\";overlayWrapper.style.left=(e.clientX-overlayAttr.offsetX-1)+\"px\"}}function stopDrag(e){if(isDragging){var top=(e.clientY-overlayAttr.offsetY-1),left=(e.clientX-overlayAttr.offsetX-1);overlayWrapper.querySelector(\".resizeMsk\").style.display=\"none\";isDragging=false;overlayWrapper.className=\"LP_UNSELECTABLE_TXT\";document.removeEventListener(\"selectstart\",preventSelection);if(overlayAttr.viewPort.height>top+overlayAttr.dimensions.height&&top>0){overlayWrapper.style.top=top+\"px\"}if(overlayAttr.viewPort.width>left+overlayAttr.dimensions.width&&left>0){overlayWrapper.style.left=left+\"px\"}overlayAttr.top=parseFloat(overlayWrapper.style.top);overlayAttr.left=parseFloat(overlayWrapper.style.left)}}function drag(e){if(isDragging){var top=(e.clientY-overlayAttr.offsetY),left=(e.clientX-overlayAttr.offsetX);if((overlayAttr.viewPort.height>top+overlayAttr.dimensions.height&&top>0)||(top<overlayAttr.top&&top>0)){overlayWrapper.style.top=top+\"px\"}else if(top>0){var maxTop=overlayAttr.viewPort.height-overlayAttr.dimensions.height;overlayWrapper.style.top=maxTop+\"px\"}else{overlayWrapper.style.top=0+\"px\"}if((overlayAttr.viewPort.width>left+overlayAttr.dimensions.width&&left>0)||(left<overlayAttr.left&&left>0)){overlayWrapper.style.left=left+\"px\"}else if(left>0){var maxLeft=overlayAttr.viewPort.width-overlayAttr.dimensions.width;overlayWrapper.style.left=maxLeft+\"px\"}else{overlayWrapper.style.left=0+\"px\"}}}function loadStyle(path){try{var link=document.createElement(\"LINK\");link.href=path;link.type=\"text/css\";link.rel=\"stylesheet\";link.addEventListener(\"load\",function(){overlayAttr.styleLoaded=true;if(overlayAttr.pending){renderOverlay()}});document.getElementsByTagName(\"head\")[0].appendChild(link)}catch(e){console.log(e)}}function setMaxDimensions(){var v=getViewPortSize(),padding=(overlayAttr.dimensions.titleHeight*2);overlayAttr.dimensions.maxHeight=v.height-padding-overlayAttr.top;overlayAttr.dimensions.maxWidth=v.width-overlayAttr.left-padding}function isFrameOpen(){try{if(window.top!=window.self&&parent.document.getElementById(\"LP_CHAT_DIALOG\")){return true}else{return false}}catch(e){}return false}return{init:function(options){if(!isFrameOpen()){var finalOptions={};finalOptions.server=options.server;finalOptions.protocol=options.protocol||'https';finalOptions.cssLocation=options.cssLocation||'/hcp/chatWindowSkins/frameChat/css/style.css';finalOptions.skin=options.cssFullLink||finalOptions.protocol+\"://\"+finalOptions.server+finalOptions.cssLocation;finalOptions.imageLocation=options.imageLocation||'/hcp/chatWindowSkins/frameChat/images';finalOptions.imagesPath=options.imagesPath||finalOptions.protocol+'://'+finalOptions.server+finalOptions.imageLocation;finalOptions.showPopOut=options.showPopOut;init(finalOptions)}},openFrame:function(options){if(!isFrameOpen()){if(!frame){var hostDomain=document.location.toString().match(/^https?:\\/\\/[^/]{1,}/);if(!hostDomain){console.log(\"Host origin not found for \"+document.location.toString());return}overlayAttr.top=parseFloat(options.top||overlayAttr.top);overlayAttr.left=parseFloat(options.left||overlayAttr.left);options.height=parseFloat(options.height);options.width=parseFloat(options.width);setMaxDimensions();options.height=(options.height<overlayAttr.dimensions.maxHeight)?options.height:overlayAttr.dimensions.maxHeight;options.width=(options.width<overlayAttr.dimensions.maxWidth)?options.width:overlayAttr.dimensions.maxWidth;overlayAttr.src=options.src;overlayAttr.dimensions.width=parseFloat(options.width);overlayAttr.dimensions.height=parseFloat(options.height)+overlayAttr.dimensions.titleHeight;overlayAttr.title=options.title||overlayAttr.title;overlayAttr.origin=overlayAttr.src.match(/^https?:\\/\\/[^/]{1,}/)[0];overlayAttr.hostOrigin=hostDomain[0];if(overlayAttr.styleLoaded){renderOverlay()}else{overlayAttr.pending=true;renderStandBy()}}}},closeFrame:function(){closeFrame(true)},resizeFrame:function(width,height){resize(width,height)},setTitle:function(title){overlayAttr.title=title;setDialogUI()},setStyle:function(cssObj){}}})()}"},{"code_id": "SYSTEM!dynamicButton_compact.js", "js_code": "function lpUtilPoint(x,y){this.x=x;this.y=y}lpUtilPoint.prototype.toString=function(){return this.x+'x'+this.y};function lpUtilRect(ul,br){this.ul=ul;this.br=br;this.intersects=function(other){return!((this.ul.x>other.br.x)||(this.br.x<other.ul.x)||(this.ul.y>other.br.y)||(this.br.y<other.ul.y))}}lpUtilRect.prototype.toString=function(){return'['+this.ul.toString()+'-'+this.br.toString()+']'};function lpUtilOverlapElement(el){this.el=el;this.iv=el.style.visibility;this.rect=this.getRect();this.restore=function(){this.el.style.visibility='visible'};this.hide=function(){this.el.style.visibility='hidden'};this.intersects=function(invRect){return!this.rect.intersects(invRect)};this.isHidden=function(){return this.el.style.visibility=='hidden'}}lpUtilOverlapElement.prototype.getRect=function(){var ul=new lpUtilPoint(this.el.offsetLeft,this.el.offsetTop),parent=this.el.offsetParent;while(parent&&(parent.tagName.toUpperCase()!='BODY')){ul.x+=parent.offsetLeft;ul.y+=parent.offsetTop;parent=parent.offsetParent}var br=new lpUtilPoint(ul.x+this.el.offsetWidth,ul.y+this.el.offsetHeight);return new lpUtilRect(ul,br)};function lpDynButton(objName,overwriteObj,buttonName,refresh,chanel,tooltip,divID,posX,posY,onTopIE,ieOnTopColour,hideObjects,relativeWidth,relativeHeight,contentType,imageUrl,onlineButImg,offlineButImg,busyButImg,alternateButImg,defaultButImg,htmlContainer,windowDimensions,LEAppID,buttonID,embedded,showPopOutOption,useFormatedSSOURL){this.embedded=embedded;this.showPopOut=showPopOutOption;this.buttonMaxLength=350;this.maxErrorRequests=3;this.ErrorRequestDelay=5;this.ver='8.2';this.firstCall=true;this.loopTimer=-1;this.connErrorCnt=0;this.LEAppID=LEAppID;this.LEAppPrefix='dynBut:';this.LEeventSent=false;this.buttonID=buttonID;this.objName=objName;this.useFormatedSSOURL=useFormatedSSOURL;if(overwriteObj!=''&&overwriteObj!='null'&&eval('typeof('+overwriteObj+')')!='undefined'){this.overwriteObj=eval(overwriteObj)}else{this.overwriteObj=new Object()}var i,db,prop;this.butConfig=new Object();for(i=0;i<lpMTagConfig.dynButton.length;i++){db=lpMTagConfig.dynButton[i];if(db.name==buttonName){for(prop in db){this.butConfig[prop]=db[prop]}}}if(typeof(onTopIE)=='undefined'||lpMTag.lpBrowser!='IE'){this.onTopIE=false;this.ieOnTopColour=\"\"}else{if(onTopIE==1){this.onTopIE=true}this.ieOnTopColour=ieOnTopColour}this.origButtonName=buttonName;this.buttonName=buttonName;this.roomName=(typeof(lpMTagConfig.buttonRoom)=='undefined')?this.buttonName:lpMTagConfig.buttonRoom;this.extConfig={};for(i=0;i<lpMTagConfig.dynButton.length;i++){db=lpMTagConfig.dynButton[i];if(db.name==this.buttonName){for(prop in db){this.extConfig[prop]=db[prop]}break}}this.refresh=refresh;this.tooltip=tooltip;this.voice=(chanel==2);this.contentType=contentType;if(this.contentType==0){this.imageUrl=imageUrl;if(this.imageUrl.indexOf('http')!=0){this.imageUrl=lpMTagConfig.lpProtocol+\"://\"+lpMTagConfig.lpServer+this.imageUrl}this.imgOnlineName=this.imageUrl+(this.voice?'voice_':'')+'reponline.gif';this.imgOfflineName=this.imageUrl+(this.voice?'voice_':'')+'repoffline.gif';this.imgBusyName=this.imageUrl+(this.voice?'voice_':'')+'repoccupied.gif';this.imgAlternateName=this.imageUrl+(this.voice?'voice_':'')+'alternate.gif';this.imgDefaultName=this.imageUrl+(this.voice?'voice_':'')+'transparent.gif'}else if(this.contentType==1){this.imgOnlineName=onlineButImg;this.imgOfflineName=offlineButImg;this.imgBusyName=busyButImg;this.imgAlternateName=alternateButImg;this.imgDefaultName=defaultButImg}else if(this.contentType==2){this.htmlContainerRef=eval(htmlContainer);this.onlineHTML=this.addActionHook('online');this.offlineHTML=this.addActionHook('offline');this.busyHTML=this.addActionHook('busy');this.alternateHTML=this.addActionHook('alternate');this.defaultHTML=this.addActionHook('default')}this.windowDimensions=windowDimensions;this.randomNum=Math.round(1000*Math.random());this.posX=-1;this.posY=-1;this.createDiv=false;this.imageID='';this.divID='';this.lastResult=-1;this.innerHtml='';this.imageID='lpDynamicButtonImg-'+this.randomNum;this.hrefID='lpDynamicButtonHref-'+this.randomNum;this.ifrmID='lpDynameicButtonIframe-'+this.randomNum;this.ifrmRef=null;if(this.contentType==0||this.contentType==1){this.butHtml=\"<a href='#' id='\"+this.hrefID+\"' STYLE='cursor:default'>\";this.butHtml+=\"<img id='\"+this.imageID+\"' name='\"+this.imageID+\"' border='0' style='border: 0px none' style='display: block;'/></a>\"}else{this.butHtml=this.defaultHTML}this.useOverrideDiv=false;this.relativeWidth=relativeWidth;this.relativeHeight=relativeHeight;this.screenWidth=this.GetPageWidth();this.screenHeight=this.GetPageHeight();if(divID==''||divID==null||divID=='null'){this.createDiv=true;this.posX=posX;this.posY=posY;this.divID='lpDynamicButtonDiv-'+this.randomNum;if(this.relativeWidth>=0||this.relativeHeight>=0){this.posX=this.screenWidth*this.relativeWidth/100;this.posY=this.screenHeight*this.relativeHeight/100}}else{this.useOverrideDiv=true;this.divID=divID;this.createDiv=false}if(navigator.appVersion.indexOf('IE 5.')>=0){this.pointerStyle='hand'}else{this.pointerStyle='pointer'}this.AVAILIABLE='Available';this.BUSY='Busy';this.OFFLINE='Offline';this.redirAttempts=10;this.redirTimeout=500;this.zIndex=300;this.buttonState='none';this.hideObjects=(hideObjects==1);this.elsObjArray=new Array();this.elsHidden=new Array();if(this.onTopIE&&this.hideObjects){this.hideObjects=false;this.onTopIE=true}if(this.hideObjects){this.elsObjArray=this.getAllProblematicElements();if(this.elsObjArray.length==0){this.hideObjects=false}}if(this.createDiv){this.hcCreateGenericDiv(this.divID,this.zIndex,this.posX,this.posY,this.butHtml,null,null,false)}else{var d=this.GetObj(this.divID);if(d!=null){d.innerHTML=this.butHtml}}this.registeredEvents=[];if(this.embedded){if(typeof(window.lpMTagConfig.frameAPI)!='undefined'&&typeof(window.lpMTagConfig.frameAPI.openFrame)=='function'){var options={server:lpMTagConfig.lpServer,protocol:lpMTagConfig.lpProtocol,showPopOut:this.showPopOut};window.lpMTagConfig.frameAPI.init(options)}else{this.log(\"frameAPI is undefined - unable to init iFrame\",\"ERROR\")}}}lpDynButton.prototype.addActionHook=function(state){var html=this.htmlContainerRef[state];if(typeof(html)!='undefined'&&html){var onClickEventStr=state!='default'?this.objName+'.actionHook();':'';return html.replace(/ON_CLICK_EVENT/g,onClickEventStr)}else{return''}};lpDynButton.prototype.setTooltip=function(str){var obj=this.GetObj(this.hrefID);if(obj!=null){obj.title=str}obj=this.GetObj(this.imageID);if(obj!=null){obj.alt=str}};lpDynButton.prototype.registerToEvent=function(ev,fn){if(typeof(lpMTag)!='undefined'&&typeof(lpMTag.events)!='undefined'){var eventData={};eventData.id=lpMTag.events.register(ev,fn);eventData.eventName=ev;this.registeredEvents[this.registeredEvents.length]=eventData}};lpDynButton.prototype.Start=function(){var that=this;this.registerToEvent('LP_SESSION_INACTIVE',function(){that.ProcessInactive()});this.registerToEvent('EMT_BEFORE_SETPAGE',function(){that.clearState()});if(!this.EventHandler('start')){return true}if(this.contentType==0||this.contentType==1){this.imgOnline=new Image();if(this.imgOnlineName!=''){this.imgOnline.src=this.imgOnlineName}this.imgOffline=new Image();if(this.imgOfflineName!=''){this.imgOffline.src=this.imgOfflineName}this.imgBusy=new Image();if(this.imgBusyName!=''){this.imgBusy.src=this.imgBusyName}this.imgAlternate=new Image();if(this.imgAlternateName!=''){this.imgAlternate.src=this.imgAlternateName}this.imgDefault=new Image();if(this.imgDefaultName!=''){this.imgDefault.src=this.imgDefaultName}this.refImage=this.GetObj(this.imageID);if(this.refImage){this.setTooltip(this.tooltip);this.refImage.onclick=function(){that.defaultAction();return false};if(this.refImage.alt!=''){var tempAlt=this.refImage.alt;this.refImage.alt='';}if(this.refImage.width!=24&&this.refImage.width!=28&&this.refImage.width>0){this.refImage.alt=tempAlt;this.StartQuery();}else{this.refImage.alt=tempAlt;this.refImage.onload=function(){that.StartQuery()}}if(this.imgDefaultName!=''){this.refImage.src=this.imgDefaultName}}}else{this.StartQuery()}};lpDynButton.prototype.StartQuery=function(){if(this.contentType!=2){this.refImage.onload=null}if(!this.EventHandler('shown')){return true}if(this.hideObjects){this.HideElements()}if(this.onTopIE){this.CreateUpdateIframe()}this.DisplayDIV();if(this.extConfig.afterStartPage){var that=this;lpMTagConfig.ifVisitorCode[lpMTagConfig.ifVisitorCode.length]=function(){that.onVisitor()}}else{this.MakeCall()}};lpDynButton.prototype.onVisitor=function(){this.MakeCall()};lpDynButton.prototype.CreateUpdateIframe=function(){var w=this.refImage.width,h=this.refImage.height,x=0,y=0;if(this.useOverrideDiv){var d=this.GetObj(this.divID);if(d==null){if(lpConnLib.DebugDisplay){lpMTagDebug.Display('DynBut could not get ref to override DIV: '+this.divID+' obj: '+this.objName,'ERROR')}this.onTopIE=false;return}else{y=d.offsetTop;x=d.offsetLeft}}else{x=this.posX;y=this.posY}if(this.ifrmRef==null){if(lpConnLib.DebugDisplay){lpMTagDebug.Display('DynBut '+this.objName+' CREATING IFRAME:'+this.ifrmID+' '+this.ieOnTopColour,'DEBUG')}this.ifrmRef=document.createElement(\"IFRAME\");this.ifrmRef.setAttribute(\"id\",this.ifrmID);this.ifrmRef.setAttribute(\"src\",lpMTagConfig.lpProtocol+'://'+lpMTagConfig.lpServer+'/hcp/html/blankhtml.html');if(this.ieOnTopColour!=''&&this.ieOnTopColour!='null'){var div=this.GetObj(this.divID);div.style.backgroundColor=this.ieOnTopColour}this.ifrmRef.style.filter=\"progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0);\";this.ifrmRef.style.style=\"progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0);\";this.ifrmRef.frameBorder='0';this.ifrmRef.scrolling='no';this.ifrmRef.style.top=y+\"px\";this.ifrmRef.style.left=x+\"px\";this.ifrmRef.style.position='absolute';this.ifrmRef.style.width=w+'px';this.ifrmRef.style.height=h+'px';this.ifrmRef.style.zIndex=this.zIndex-1;this.ifrmRef.style.visibility='hidden';document.body.appendChild(this.ifrmRef)}else{if(lpConnLib.DebugDisplay){lpMTagDebug.Display('DynBut '+this.objName+' UPDATING IFRAME:'+this.ifrmID+' '+this.ieOnTopColour+' w/h='+w+'/'+h,'DEBUG')}if(w==1&&h==1){setTimeout(this.objName+'.CreateUpdateIframe()',400)}this.ifrmRef.style.width=w+'px';this.ifrmRef.style.height=h+'px'}};lpDynButton.prototype.onVisitor=function(){this.MakeCall()};lpDynButton.prototype.addFirstPartyCookies=function(url){if(typeof(lpMTagConfig.useFirstParty)!='undefined'&&lpMTagConfig.useFirstParty){if(url.indexOf('?')==-1){url+='?'}var vid=lpMTag.lpGetCookie(lpMTagConfig.lpNumber+'-VID');if(vid!=null){url+='&visitor='+vid;var skey=lpMTag.lpGetCookie(lpMTagConfig.lpNumber+\"-SKEY\");if(skey!=null){url+='&msessionkey='+skey}}}return url};lpDynButton.prototype.MakeCall=function(){var that=this,cParam=new hcArrayStorage(),url=lpMTagConfig.lpProtocol+'://'+lpMTagConfig.lpServer+'/hc/'+lpMTagConfig.lpNumber+'/';if(lpMTag.addFirstPartyCookies){url=lpMTag.addFirstPartyCookies(url)}else{url=this.addFirstPartyCookies(url)}cParam.add('cmd','mTagUrl');cParam.add('site',lpMTagConfig.lpNumber);cParam.add('SV!impression-query-name',this.buttonName);cParam.add('SV!impression-query-room',this.roomName);cParam.add('id',lpMTag.lpPageID);cParam.add('info','button-impression:'+this.buttonName+'('+document.title+')');cParam.add('waitForVisitor','true');cParam.add('d',(new Date().getTime()));cParam.add('page',lpMTagConfig.lpProtocol+'://'+lpMTagConfig.lpServer+'/hcp/width/img40.gif');if(this.getExtraInfo()!=''){var extra=this.getExtraInfo().split('&');for(var i=0;i<extra.length;i++){cParam.add(extra[i],undefined,true)}}if(lpMTag.mtagAddToQueue){lpMTag.mtagAddToQueue(url,cParam,function(d){that.DynButtonCallback(d)},true)}else{lpConnLib.addToQueue(url,cParam,function(d){that.DynButtonCallback(d)},true)}};lpDynButton.prototype.DynButtonCallback=function(dataObj){var that=this;if(typeof(dataObj.ResultSet.lpCallError)!='undefined'){this.connErrorCnt++;if(dataObj.ResultSet.lpCallError==\"NO-VISITOR\"){if(typeof(lpMTagConfig.ifVisitorCode)=='undefined'){lpMTagConfig.ifVisitorCode=[]}lpMTagConfig.ifVisitorCode[lpMTagConfig.ifVisitorCode.length]=function(){that.onVisitor()};return}else if(dataObj.ResultSet.lpCallError==\"NOT-ACTIVE\"){this.ProcessResult('inactive');return}else if(this.connErrorCnt<this.maxErrorRequests){this.loopTimer=setTimeout(this.objName+'.MakeCall()',this.connErrorCnt*this.ErrorRequestDelay*1000)}return}this.firstCall=false;var result=dataObj.ResultSet.lpData[0].result;this.ProcessResult(result);if(typeof(this.loopTimer)!='undefined'){clearTimeout(this.loopTimer)}if(this.refresh!=-1){this.loopTimer=setTimeout(this.objName+'.MakeCall()',this.refresh*1000)}};lpDynButton.prototype.ProcessInactive=function(){this.buttonState='inactive';if(!this.EventHandler('state')){return true}if(this.contentType==0||this.contentType==1){if(this.imgDefaultName!=''){this.refImage.src=this.imgDefaultName}this.refImage.alt='';this.refImage.onclick='';this.setCursorStyle('default');this.setTooltip('')}else{this.setDIVContent(this.defaultHTML)}if(this.onTopIE){this.CreateUpdateIframe()}};lpDynButton.prototype.ProcessResult=function(result){if(lpConnLib.DebugDisplay){lpMTagDebug.Display('DynBut '+this.origButtonName+' query result='+result,'DEBUG')}if(this.lastResult==result){return}this.lastResult=result;if(result==40){return}if(!this.voice&&!this.LEeventSent){this.reportImpression()}var that=this;if(result==50||result==56){this.buttonState='online';if(!this.EventHandler('state')){return true}if(this.contentType==0||this.contentType==1){if(this.imgOnlineName!=''){this.refImage.src=this.imgOnlineName}this.refImage.alt=this.tooltip;this.refImage.onclick=function(){that.onlineAction();return false};this.setCursorStyle(this.pointerStyle);this.setTooltip(this.tooltip)}else{this.setDIVContent(this.onlineHTML)}if(this.onTopIE){this.CreateUpdateIframe()}}else if(result==60||result==66){if(this.contentType==2){this.buttonState='busy';if(!this.EventHandler('state')){return true}this.setDIVContent(this.busyHTML)}else{if(this.imgBusy.width>0){this.buttonState='busy';if(!this.EventHandler('state')){return true}if(this.imgBusyName!=''){this.refImage.src=this.imgBusyName}this.refImage.alt='';this.setCursorStyle('default');this.setTooltip('');if(typeof(this.overwriteObj.busyAction)!='undefined'){this.refImage.onclick=function(){that.busyAction();return false}}else{this.refImage.onclick=null}}}if(this.onTopIE){this.CreateUpdateIframe()}}else if(result==70||result==76){if(this.contentType==2){this.buttonState='offline';if(!this.EventHandler('state')){return true}this.setDIVContent(this.offlineHTML)}else{if(this.imgOffline.width>0){this.buttonState='offline';if(!this.EventHandler('state')){return true}if(this.imgOfflineName!=''){this.refImage.src=this.imgOfflineName}this.refImage.alt='';this.setCursorStyle('default');this.setTooltip('');if(typeof(this.overwriteObj.offlineAction)!='undefined'){this.refImage.onclick=function(){that.offlineAction();return false}}else{this.refImage.onclick=null}}}if(this.onTopIE){this.CreateUpdateIframe()}}else if(result==80||result==0||result==86){if(this.contentType==2){this.buttonState='alternate';if(!this.EventHandler('state')){return true}this.setDIVContent(this.alternateHTML)}else{if(this.imgAlternate.width>0){this.buttonState='alternate';if(!this.EventHandler('state')){return true}if(this.imgAlternateName!=''){this.refImage.src=this.imgAlternateName}this.refImage.alt='';this.setCursorStyle(this.pointerStyle);this.setTooltip('');this.refImage.onclick=function(){that.alternateAction();return false}}}if(this.onTopIE){this.CreateUpdateIframe()}}else if(result==90||result==96){this.buttonState='status90';if(!this.EventHandler('state')){return true}if(this.contentType==0||this.contentType==1){this.refImage.alt='';this.refImage.onclick=function(){that.onlineAction();return false};this.setCursorStyle(this.pointerStyle);this.setTooltip(this.tooltip)}else{this.setDIVContent(this.onlineHTML)}if(this.onTopIE){this.CreateUpdateIframe()}}};lpDynButton.prototype.reportImpression=function(){if(lpConnLib.DebugDisplay){lpMTagDebug.Display('Delaying impression sending','DEBUG','DYNBUTTON')}this.sendImpression()};lpDynButton.prototype.sendImpression=function(){if(typeof(lpMTagConfig.LEeventsAPI)!='undefined'&&lpMTagConfig.LEeventsAPI){this.initLEeventsAPI();if(typeof(lpMTagConfig.liveEngage)!='undefined'){this.LEeventSent=true;lpMTagConfig.liveEngage.sendImpression(this.LEAppID,this.LEAppPrefix+this.buttonID)}}else{if(lpConnLib.DebugDisplay){lpMTagDebug.Display('lpMTagConfig.LEeventsAPI is false','DEBUG','DYNBUTTON')}}};lpDynButton.prototype.initLEeventsAPI=function(){if(typeof(lpMTagConfig)!='undefined'&&typeof(lpMTagConfig.liveEngage)=='undefined'){lpMTagConfig.liveEngage={type:{impression:\"impression\",engage:\"engage\"},rdrDefault:{url:\"\",name:\"_self\",specs:\"\"},_sendEvent:function(appId,type,strData,redirectData){if(typeof(appId)=='undefined'){this._log(\"appId was not defined\",\"ERROR\");return false}if(typeof(lpMTagConfig.LEeventsAPI)=='undefined'||!lpMTagConfig.LEeventsAPI){this._log(\"Older app server version unified reports not supported (lpMTagConfig.LEeventsAPI != true)\",\"ERROR\");return false}this._log(\"Sending\"+type+\" event for application: \"+appId);var params=new hcArrayStorage();params.add('site',lpMTagConfig.lpNumber);params.add('cmd','leVisitorEvent');params.add('type',type);params.add('appKey',appId);params.add('data',strData);var url=lpMTagConfig.lpProtocol+'://'+lpMTagConfig.lpServer+'/hc/'+lpMTagConfig.lpNumber+'/';if(typeof(redirectData)=='undefined'||redirectData==null){if(typeof(lpConnLib)!='undefined'&&typeof(lpConnLib.addToQueue)!='undefined'){lpConnLib.addToQueue(url,params,null,true,3,true,true,5);return true}else{this._log(\"lpConnLib or lpConnLib.addToQueue are not defined\",\"ERROR\");return false}}else{var rdrObj={};this._objectClone(this.rdrDefault,rdrObj);if(typeof(redirectData)=='string'){rdrObj.url=redirectData}else{this._objectClone(redirectData,rdrObj)}return this._sendEventRedirect(url,params,rdrObj)}},_sendEventRedirect:function(url,params,rdrObj){if(typeof(rdrObj.url)=='undefined'||rdrObj.url==null||rdrObj.url==\"\"){this._log(\"redirect url was not defined or empty\");return false}params.add('redirect',rdrObj.url);return window.open(this._getRedirectUrl(url,params),rdrObj.name,rdrObj.specs)},_getRedirectUrl:function(url,params){var request=new lpRequest(lpConnLib.protocolVer,url,params,null,false,null,lpConnLib.prunIdentify,5,\"UTF-8\",lpConnLib.browser,false,null,undefined,0,0,true,false,undefined,undefined,undefined,undefined);request.BuildCallUrl('get',lpConnLib.maxurlgetlength,true);return request.fullUrl},_objectClone:function(source,target){var key;for(key in source){target[key]=source[key]}},_log:function(msg,type){type=(type?type:'DEBUG');if(typeof(lpMTagDebug)!='undefined'&&typeof(lpMTagDebug.Display)=='function'){lpMTagDebug.Display(msg,type,'LiveEngage.Report')}},sendImpression:function(appId,strData){return this._sendEvent(appId,this.type.impression,strData)},sendEngagement:function(appId,strData,redirectData){return this._sendEvent(appId,this.type.engage,strData,redirectData)}}}};lpDynButton.prototype.setDIVContent=function(html){var d=this.GetObj(this.divID);if(d!=null){d.innerHTML=html}else{if(lpConnLib.DebugDisplay){lpMTagDebug.Display('DynBut could not get ref to DIV: '+this.divID+' obj: '+this.objName,'ERROR')}}};lpDynButton.prototype.setCursorStyle=function(st){this.refImage.cursor=st;var ref=this.GetObj(this.hrefID);ref.style.cursor=st};lpDynButton.prototype.actionHook=function(){switch(this.buttonState){case \"online\":this.onlineAction();break;case \"offline\":this.offlineAction();break;case \"busy\":this.busyAction();break;case \"alternate\":this.alternateAction();break;case \"default\":this.defaultAction();break;default:this.onlineAction()}};lpDynButton.prototype.defaultAction=function(){if(this.isMultipleClicks()){return true}if(!this.EventHandler('clicked')){return true}if(typeof(this.overwriteObj.defaultAction)!='undefined'){this.overwriteObj.defaultAction(this.objName)}};lpDynButton.prototype.onlineAction=function(){if(this.isMultipleClicks()){return true}if(!this.EventHandler('clicked')){return true}if(typeof(this.overwriteObj.onlineAction)!='undefined'){this.overwriteObj.onlineAction(this.objName)}else{this.openChatWin(this.AVAILIABLE)}};lpDynButton.prototype.offlineAction=function(){if(this.isMultipleClicks()){return true}if(!this.EventHandler('clicked')){return true}if(typeof(this.overwriteObj.offlineAction)!='undefined'){this.overwriteObj.offlineAction(this.objName)}};lpDynButton.prototype.busyAction=function(){if(this.isMultipleClicks()){return true}if(!this.EventHandler('clicked')){return true}if(typeof(this.overwriteObj.busyAction)!='undefined'){this.overwriteObj.busyAction(this.objName)}};lpDynButton.prototype.alternateAction=function(){if(this.isMultipleClicks()){return true}if(!this.EventHandler('clicked')){return true}if(typeof(this.overwriteObj.alternateAction)!='undefined'){this.overwriteObj.alternateAction(this.objName)}};lpDynButton.prototype.isMultipleClicks=function(){var timeDelay=0;if(typeof(lpMTagConfig.dbMultipleClickDelay)!='undefined'){timeDelay=lpMTagConfig.dbMultipleClickDelay}if(typeof(this.extConfig.dbMultipleClickDelay)!='undefined'){timeDelay=this.extConfig.dbMultipleClickDelay}var timeNow=(new Date()).getTime();if(timeDelay>0){if(typeof(lpMTagConfig.dbLastClicked)!='undefined'){if((timeNow-lpMTagConfig.dbLastClicked)<(timeDelay*1000)){if(lpConnLib.DebugDisplay){lpMTagDebug.Display('DynBut '+this.objName+' multiple clicked:','DEBUG')}return true}}}lpMTagConfig.dbLastClicked=timeNow;return false};lpDynButton.prototype.openChatWin=function(buttonState){var windowName=(this.voice?'call':'chat')+lpMTagConfig.lpNumber;this.updateWindowDimensions();var url=this.getActionURL(buttonState).replace(lpMTagConfig.lpProtocol,\"https\");if(this.embedded&&window.addEventListener&&!this.voice){if(typeof(window.lpMTagConfig.frameAPI)!='undefined'&&typeof(window.lpMTagConfig.frameAPI.openFrame)=='function'){var options={src:url,width:this.windowWidth,height:this.windowHeight,title:'Chat'};window.lpMTagConfig.frameAPI.openFrame(options);return}else{this.log(\"frameAPI is undefined - unable to embed chat\",\"ERROR\")}}window.open(url,windowName,'width='+this.windowWidth+',height='+this.windowHeight+',status=0,resizable=0,menubar=no,scrollbars=no')};lpDynButton.prototype.updateWindowDimensions=function(){var curWindowDimensions=this.windowDimensions[this.buttonState]||this.windowDimensions['none'];this.windowWidth=curWindowDimensions.width;this.windowHeight=curWindowDimensions.height};lpDynButton.prototype.getActionURL=function(buttonState){var url=lpMTagConfig.lpProtocol+\"://\"+lpMTagConfig.lpServer+\"/hc/\"+lpMTagConfig.lpNumber+\"/cmd/url/?site=\"+lpMTagConfig.lpNumber;if(lpMTag.addFirstPartyCookies){url=lpMTag.addFirstPartyCookies(url)}else{url=this.addFirstPartyCookies(url)}url+=\"&SV!click-query-name=\"+escape(this.buttonName)+\"&SV!click-query-room=\"+escape(this.roomName)+\"&SV!click-query-state=\"+escape(buttonState)+\"&SV!click-query-channel=\"+(this.voice?'voice':'web')+\"&page=\"+escape(this.getWinURL(buttonState))+\"&id=\"+lpMTag.lpPageID+\"&waitForVisitor=redirectBack&redirectAttempts=\"+this.redirAttempts+\"&redirectTimeout=\"+this.redirTimeout+\"&\"+this.getExtraInfo()+\"&d=\"+(new Date().getTime());return url};lpDynButton.prototype.ssoFixURL=function(ssoURL,redirectURL){var ch=\"?\";if(ssoURL.indexOf(\"?\")!=-1){var lastChar=ssoURL.charAt(ssoURL.length-1);if(lastChar=='?'||lastChar=='&'){ch=\"\"}else{ch=\"&\"}}return ssoURL+ch+\"redirect=\"+escape(redirectURL)};lpDynButton.prototype.CheckAttachSSO=function(url){this.useSSO=false;this.SSOurl='';if(typeof(this.butConfig.noSSO)!='undefined'&&this.butConfig.noSSO){return url}if(typeof(this.butConfig.SSOURL)!='undefined'&&this.butConfig.SSOURL!=''){this.useSSO=true;this.SSOurl=this.butConfig.SSOURL;if(this.useFormatedSSOURL){url=this.ssoFixURL(this.butConfig.SSOURL,url)}else{url=this.butConfig.SSOURL+'?'+url}return url}if(typeof(lpMTagConfig.SSOURL)!='undefined'&&lpMTagConfig.SSOURL!=''){this.useSSO=true;this.SSOurl=lpMTagConfig.SSOURL;if(this.useFormatedSSOURL){url=this.ssoFixURL(this.SSOurl,url)}else{url=lpMTagConfig.SSOURL+'?'+url}return url}if(typeof(lpMTagConfig.sso_keygen_url)!='undefined'&&lpMTagConfig.sso_keygen_url!=''){this.useSSO=true;this.SSOurl=lpMTagConfig.sso_keygen_url;if(this.useFormatedSSOURL){url=this.ssoFixURL(this.SSOurl,url)}else{url=lpMTagConfig.sso_keygen_url+'?'+url}return url}return url};lpDynButton.prototype.getWinURL=function(buttonState){var referrerString=\"&referrer=(button%20dynamic-button:\"+escape(this.buttonName)+\"(\"+escape(document.title)+\"))%20\"+this.LimitString(escape(document.location),200),forceOfflineString=(buttonState!=this.AVAILIABLE)?(\"&forceOffline=true&SV!OfflineTrigger=\"+buttonState+\"Click\"):\"\",cmd=this.voice?\"visitorWantsToTalk\":\"visitorWantsToChat\",url=lpMTagConfig.lpProtocol+\"://\"+lpMTagConfig.lpServer+\"/hc/\"+lpMTagConfig.lpNumber+\"/?cmd=file&file=\"+cmd+\"&site=\"+lpMTagConfig.lpNumber;if(lpMTag.addFirstPartyCookies){url=lpMTag.addFirstPartyCookies(url)}else{url=this.addFirstPartyCookies(url)}if(!this.voice){url+=\"&LEAppKey=\"+this.LEAppID}url+=forceOfflineString+\"&SV!chat-button-name=\"+escape(this.buttonName)+\"&SV!chat-button-room=\"+escape(this.roomName)+referrerString;url=this.CheckAttachSSO(url);return url};lpDynButton.prototype.getExtraInfo=function(){for(var i=0;i<lpMTagConfig.dynButton.length;i++){if(lpMTagConfig.dynButton[i].name==this.origButtonName){if(typeof(lpMTagConfig.dynButton[i].extra)!='undefined'){return lpMTagConfig.dynButton[i].extra}else{return''}}}return''};lpDynButton.prototype.getDate=function(){var d=new Date();return d.getTime()};lpDynButton.prototype.DisplayDIV=function(){if(this.onTopIE){this.ifrmRef.style.visibility='visible'}var objCont=this.GetObj(this.divID);if(objCont){objCont.style.visibility='visible'}};lpDynButton.prototype.HideDIV=function(){if(this.onTopIE){this.ifrmRef.style.visibility='hidden'}this.GetObj(this.divID).style.visibility='hidden'};lpDynButton.prototype.hcCreateGenericDiv=function(id,zindex,left,top,innerHtml,cursor,onclickFunction,isVisible){if(!document.getElementsByTagName){return}var body=document.getElementsByTagName('body');if(!body){return}if(this.GetObj(id)!=null){return}var divE=document.createElement('div');divE.setAttribute('id',id);divE.setAttribute('name',id);divE.style.zIndex=zindex;divE.style.position='absolute';divE.style.visibility=isVisible?'visible':'hidden';divE.style.left=left+'px';divE.style.top=top+'px';if(cursor!=null){divE.style.cursor=cursor}if(onclickFunction!=null){divE.onclick=onclickFunction}divE.innerHTML=innerHtml;if(document.body.firstChild!=null){document.body.insertBefore(divE,document.body.firstChild)}else{body.appendChild(divE)}};lpDynButton.prototype.GetObj=function(id){if(document.getElementById){return document.getElementById(id)}else{if(document.all){return document.all(id)}}return null};lpDynButton.prototype.LimitString=function(str,maxsize){if(str.length>maxsize){return str.substring(0,maxsize)}else{return str}};lpDynButton.prototype.EventHandler=function(ev){if(lpConnLib.DebugDisplay){var txt=ev;if(ev=='state'){txt=ev+' '+this.buttonState}lpMTagDebug.Display('DynBut '+this.objName+' EVENT: '+txt,'DEBUG')}switch(ev){case 'start':this.mTagEvent('LP_DYNBUTTON_START');if(typeof(this.overwriteObj.dbStart)!='undefined'){return this.overwriteObj.dbStart(this.objName)}break;case 'shown':this.mTagEvent('LP_DYNBUTTON_SHOWN');if(typeof(this.overwriteObj.dbShown)!='undefined'){return this.overwriteObj.dbShown(this.objName)}break;case 'clicked':this.mTagEvent('LP_DYNBUTTON_CLICKED');if(typeof(this.overwriteObj.dbClicked)!='undefined'){return this.overwriteObj.dbClicked(this.objName,this.buttonState)}break;case 'state':this.mTagEvent('LP_DYNBUTTON_STATE');if(typeof(this.overwriteObj.dbStateChange)!='undefined'){return this.overwriteObj.dbStateChange(this.objName,this.buttonState)}break}return true};lpDynButton.prototype.GetPageHeight=function(){if(window.innerHeight){return window.innerHeight}else if(document.documentElement&&document.documentElement.clientHeight){return document.documentElement.clientHeight}else if(document.body){return document.body.clientHeight}};lpDynButton.prototype.GetPageWidth=function(){if(document.documentElement&&document.documentElement.clientWidth){return document.documentElement.clientWidth}else if(document.body){return document.body.clientWidth}else{return window.innerWidth}};lpDynButton.prototype.getDBRect=function(){var div=new lpUtilOverlapElement(this.GetObj(this.divID));return div.getRect()};lpDynButton.prototype.HideElements=function(){if(!this.hideObjects){return}var dbRect=this.getDBRect();this.unhidePrevHiddenElements(dbRect);var length=this.elsObjArray.length;for(var i=0;i<length;i++){var hideEl=new lpUtilOverlapElement(this.elsObjArray[i]);if(!hideEl.isHidden()&&dbRect.intersects(hideEl.rect)){this.elsHidden[this.elsHidden.length]=hideEl;hideEl.hide()}}};lpDynButton.prototype.unhidePrevHiddenElements=function(invRect){var tmpArr=this.elsHidden;this.elsHidden=new Array();for(var i=0;i<tmpArr.length;i++){if(!invRect.intersects(tmpArr[i].rect)){tmpArr[i].restore()}else{this.elsHidden[this.elsHidden.length]=tmpArr[i]}}};lpDynButton.prototype.getAllProblematicElements=function(){var elArray=new Array(),i,e,hide,attr;if(lpMTag.lpBrowser=='IE'){var sels=document.getElementsByTagName('SELECT');for(i=0;i<sels.length;i++){elArray[elArray.length]=sels[i]}}if(lpMTag.lpBrowser=='IE'){var objs=document.getElementsByTagName('OBJECT');for(i=0;i<objs.length;i++){var childs=objs[i].childNodes;hide=true;for(var n=0;n<childs.length;n++){attr=childs[n].attributes;var atst='',check=false;if(attr!=null){for(e=0;e<attr.length;e++){if(attr[e].value!='null'&&attr[e].value!=null&&attr[e].value!=''){atst+=attr[e].value.toUpperCase()+' ';if(attr[e].value.toUpperCase()=='WMODE'){check=true}}}if(check&&(atst.indexOf('TRANSPARENT')!=-1||atst.indexOf('OPAQUE')!=-1)){hide=false;break}}}if(hide){elArray[elArray.length]=objs[i]}}}else{var es=document.getElementsByTagName('EMBED');for(i=0;i<es.length;i++){hide=true;attr=es[i].attributes;if(attr!=null){for(e=0;e<attr.length;e++){if(attr[e].name.toUpperCase()=='WMODE'&&(attr[e].value.toUpperCase()=='TRANSPARENT'||attr[e].value.toUpperCase()=='OPAQUE')){hide=false;break}}}if(hide){elArray[elArray.length]=es[i]}}}var as=document.getElementsByTagName('APPLET');for(i=0;i<as.length;i++){elArray[elArray.length]=as[i]}return elArray};lpDynButton.prototype.clearState=function(evName,params){if(typeof(this.butConfig.pid)!=\"undefined\"&&document.getElementById(this.butConfig.pid)==null){this.clearConfig();this.clearInstance()}};lpDynButton.prototype.clearConfig=function(){try{if(typeof(lpMTagConfig.dynButton)!='undefined'){for(var i=0;i<lpMTagConfig.dynButton.length;i++){if(this.butConfig.name==lpMTagConfig.dynButton[i].name){lpMTagConfig.dynButton.splice(i,1);i--;if(lpConnLib.DebugDisplay){lpMTagDebug.Display('DynBut : '+this.butConfig.name+' removed from config','DEBUG')}}}}}catch(e){if(lpConnLib.DebugDisplay){lpMTagDebug.Display('DynBut'+this.objName+'clear from config.Error'+e,'ERROR')}}};lpDynButton.prototype.clearInstance=function(){try{if(this.loopTimer!=-1){clearTimeout(this.loopTimer)}for(i=0;i<this.registeredEvents.length;i++){var eventData=this.registeredEvents[i];lpMTag.events.unregister(eventData.id);if(lpConnLib.DebugDisplay){lpMTagDebug.Display('DynBut : '+this.butConfig.name+' unregistred from event name: '+eventData.eventName+\",event id:\"+eventData.id,'DEBUG')}}var configName=this.butConfig.name,objName=this.objName;setTimeout(function(){try{var namePart=objName.split('.');delete window[namePart[0]][namePart[1]];if(lpConnLib.DebugDisplay){lpMTagDebug.Display('DynBut : '+configName+' instance removed. ','DEBUG')}}catch(e){if(lpConnLib.DebugDisplay){lpMTagDebug.Display('Error removing instance : '+configName+'Error : '+e,'ERROR')}}},0)}catch(e){if(lpConnLib.DebugDisplay){lpMTagDebug.Display('DynBut'+this.objName+'clear instance and data .Error'+e,'ERROR')}}};lpDynButton.prototype.mTagEvent=function(evName){if(typeof(lpMTag)!='undefined'&&typeof(lpMTag.events)!='undefined'&&typeof(lpMTag.events.publish)=='function'){var evData={name:this.origButtonName,channel:(this.voice?'voice':'chat'),buttonState:this.buttonState};lpMTag.events.publish(evName,evData)}};"},{"code_id": "chat-sales-english", "js_code": "lpMTagConfig.dynButton1= new lpDynButton('lpMTagConfig.dynButton1', 'null', 'chat-sales-english', -1, 1, 'Click to Chat With an Online Representative', 'lpButtonDiv', -1, -1,0,'',0,1,1,1,'https://sales.liveperson.net/visitor/liveperson/chat-button/','https://cdn.5andp.com/brand/katespadeuk/liveperson/LiveChat_Button.jpg 	','https://sales.liveperson.net/visitor/liveperson/chat-button/transparent.gif','https://sales.liveperson.net/visitor/liveperson/chat-button/transparent.gif','https://sales.liveperson.net/visitor/liveperson/chat-button/transparent.gif','https://sales.liveperson.net/visitor/liveperson/chat-button/transparent.gif','lpJSLib.dynButton1',{none:{height:320,width:472},offline:{height:760,width:360},online:{height:760,width:360}},'f907f2d9acd64b7f8c00b83bed3c2822',9,false,false,false); lpMTagConfig.dynButton1.Start();"},{"code_id": "FPCookie", "js_code": "lpMTagConfig.FPC_VID_NAME='44275250-VID'; lpMTagConfig.FPC_VID='1718801377661359'; lpMTagConfig.FPC_SKEY_NAME='44275250-SKEY'; lpMTagConfig.FPC_SKEY='2809855599545297541';lpMTagConfig.FPC_CONT_NAME='HumanClickSiteContainerID_44275250'; lpMTagConfig.FPC_CONT='STANDALONE'"},{"code_id": "SYSTEM!firstpartycookies_compact.js", "js_code": "function lpFirstPartyCookieSupport(){this.testCookieName='lpFPCtest';this.date=new Date();this.curTime=this.date.getTime();this.newD=new Date(this.curTime+(1000*10));this.expirydate=lpMTagConfig.lpUseSessionCookies?null:this.newD.toGMTString();}lpFirstPartyCookieSupport.prototype.addFirstPartyCookies=function(){lpMTag.lpSetCookie(this.testCookieName,new String(this.curTime),this.expirydate);var value=lpMTag.lpGetCookie(this.testCookieName);if(value!=null&&value==new String(this.curTime)){lpMTag.lpDeleteCookie(this.testCookieName);var expirydate=lpMTagConfig.lpUseSessionCookies?null:365;lpMTag.lpSetCookie(lpMTagConfig.FPC_VID_NAME,lpMTagConfig.FPC_VID,expirydate,'/',lpMTagConfig.FPC_ParentDomain);lpMTag.lpSetCookie(lpMTagConfig.FPC_SKEY_NAME,lpMTagConfig.FPC_SKEY,null,'/',lpMTagConfig.FPC_ParentDomain);lpMTag.lpSetCookie(lpMTagConfig.FPC_CONT_NAME,lpMTagConfig.FPC_CONT,null,'/',lpMTagConfig.FPC_ParentDomain);}else{lpMTag.stopMTag=true;if(lpConnLib.DebugDisplay){lpMTagDebug.Display('FPC - can not set the test cookie name='+this.testCookieName+' value ='+value+' - STOPING THE MT','ERROR');}}};lpMTagConfig.firstPartyCookieSolution=new lpFirstPartyCookieSupport();lpMTagConfig.firstPartyCookieSolution.addFirstPartyCookies();"}]}});